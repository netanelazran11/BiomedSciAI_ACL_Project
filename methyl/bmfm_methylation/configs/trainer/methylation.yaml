# Trainer configuration for methylation age prediction

_target_: bmfm_targets.config.TrainerConfig

# Optimizer settings
learning_rate: 1.0e-4
weight_decay: 0.01
warmup_steps: 1000
lr_decay_steps: -1  # Use -1 to decay based on total training steps

# Adam parameters
betas:
  - 0.9
  - 0.999
epsilon: 1.0e-8

# Losses for MLM pretraining (cross entropy on masked tokens)
losses:
  - name: cross_entropy
    field_name: cpg_sites  # Compute loss on masked CpG site predictions
    label_smoothing: 0.01

# Batch prediction tracking (for rich metrics like confusion matrix)
batch_prediction_behavior: track

# Metrics
metrics:
  - name: accuracy
  - name: f1
